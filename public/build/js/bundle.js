var melisPlatformFrameworkLumenDemoTool={tempLoader:'<div id="loader" class="overlay-loader"><img class="loader-icon spinning-cog" src="/MelisCore/assets/images/cog12.svg" data-cog="cog12"></div>',currentRequest:null,refreshTool:function(){melisHelper.zoneReload("id_melis_platform_framework_lumen_demo_tool","melis_platform_framework_lumen_demo_tool")},refreshTable:function(){var e=$("#lumenDemoToolTable");$("#lumenDemoToolTable_wrapper").append(melisPlatformFrameworkLumenDemoTool.tempLoader),e.DataTable().ajax.reload(function(){$("#lumenDemoToolTable_wrapper").find("#loader").remove()})},getToolModal:function(e,o){void 0===e&&(e=null);var l="";return melisPlatformFrameworkLumenDemoTool.currentRequest=$.ajax({type:"GET",url:"/melis/get-tool-modal",data:{albumId:o}}).done(function(o){void 0!==e&&"function"==typeof e&&e(o),l=o}),l},getAlbumById:function(e){$.ajax({type:"GET",url:"/melis/get-lumen-data/"+e,dataType:"json",encode:!0}).done(function(e){console.log(e)})},saveAlbumData:function(e,o,l){void 0===o&&(o=null),void 0===l&&(l=null),$.ajax({type:"POST",url:"/melis/save-lumen-album",data:e,dataType:"json",encode:!0}).done(function(e){e.success?(void 0!==o&&"function"==typeof o&&o(),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisCoreTool.alertDanger("#prospectupdateformalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,0),melisCoreTool.highlightErrors(e.success,e.errors,"lumen_demo_tool_add_album"),void 0!==l&&"function"==typeof l&&l()),melisCore.flashMessenger()})},deleteAlbum:function(e,o){void 0===o&&(o=null),$.ajax({type:"POST",url:"/melis/delete-lumen-album",data:{albumId:e},dataType:"json",encode:!0}).done(function(e){e.success?(void 0!==o&&"function"==typeof o&&o(),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisCoreTool.alertDanger("#prospectupdateformalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,0),melisCoreTool.highlightErrors(e.success,e.errors,"idformprospectdata")),melisCore.flashMessenger(),melisCoreTool.done("#btnProspectUpdate")})}};!function(e){var o=e("body");o.on("click",".btnEditLumenAlbum",function(){var o=e(this).parent().parent().attr("id");e(".modal-dynamic-content").html(melisPlatformFrameworkLumenDemoTool.tempLoader),melisPlatformFrameworkLumenDemoTool.getToolModal(function(o){e(".modal-dynamic-content").html(o)},o)}),o.on("click","#btn-save-lumen-album",function(){e("#lumen_demo_tool_add_album").submit()}),o.on("submit","#lumen_demo_tool_add_album",function(o){o.preventDefault();var l=e("#btn-save-lumen-album");l.attr("disabled","disabled");var t=e(this).serializeArray();melisPlatformFrameworkLumenDemoTool.saveAlbumData(t,function(){e(".lumen-modal-close").trigger("click"),melisPlatformFrameworkLumenDemoTool.refreshTool()},function(){l.removeAttr("disabled")})}),o.on("click",".btnDelLumenAlbum",function(){var o=e(this).parent().parent().attr("id");melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_melis_lumen_notification_title,translations.tr_melis_lumen_notification_message_delete_message,function(){melisPlatformFrameworkLumenDemoTool.deleteAlbum(o,function(){melisPlatformFrameworkLumenDemoTool.refreshTool()})})}),o.on("click",".melis-lumen-refresh",function(){melisPlatformFrameworkLumenDemoTool.refreshTool()}),o.on("click",".add-lumen-album",function(){e(".modal-dynamic-content").html(melisPlatformFrameworkLumenDemoTool.tempLoader),melisPlatformFrameworkLumenDemoTool.getToolModal(function(o){e(".modal-dynamic-content").html(o)})}),o.on("hidden.bs.modal","#lumenModal",function(){melisPlatformFrameworkLumenDemoTool.currentRequest.abort()})}(jQuery);